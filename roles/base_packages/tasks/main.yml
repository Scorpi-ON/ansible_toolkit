---
- name: Update package cache
  ansible.builtin.package:
    update_cache: true
  when: base_packages_update_cache | bool

- name: Upgrade installed packages
  when: base_packages_upgrade | bool
  block:
    - name: Upgrade installed packages (apt) # noqa: package-latest
      ansible.builtin.package:
        name: "*"
        state: latest
      when: ansible_facts['pkg_mgr'] == 'apt'
    - name: Upgrade installed packages (pacman)
      community.general.pacman:
        upgrade: true
      when: ansible_facts['pkg_mgr'] == 'pacman'

- name: Install base packages
  ansible.builtin.package:
    name: "{{ base_packages_list }}"
  when: base_packages_list | length > 0
